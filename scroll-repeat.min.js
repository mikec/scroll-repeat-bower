angular.module("litl",[]).directive("scrollRepeat",["$window","$timeout",function(a,b){function c(){f=a.innerWidth,e=a.innerHeight,g=void 0,h&&h()}var d,e,f,g,h,i,j,k=30,l=500,m=k,n=1,o=angular.element(a),p=angular.element(a.document.body),q=500,r=0,s=500;return c(),o.bind("resize",function(){(angular.isUndefined(e)||angular.isUndefined(f)||angular.isUndefined(g))&&c(),b.cancel(g),g=b(c,q)}),o.bind("scroll",function(){r=a.document.body.scrollTop,angular.isUndefined(i)&&(i=b(function(){j&&j(),i=void 0},s)),j&&j(!0)}),{compile:function(a,c){var f=angular.element('<div class="scroll-repeat-item"></div>'),g=c.scrollRepeat,i=angular.element('<div class="scroll-repeat-item-content"></div>');i.append(a.contents()),f.append(i),a.html(""),a.append(f);var o=g.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),q=o[2];return f.attr("ng-repeat",g+" | limitTo:ofs | limitTo:lim"),function(a,c){function f(b){C=b;var c=E>m?m:E,d=c+b,e=-1*c;0===d&&(d=m),0===e&&(e=-1*m),a.ofs=d,a.lim=e,s()}function g(){var a=0;if(D>0){var b=r-F;0>b&&(b=0),a=Math.round(b/D)*n-d,0>a&&(a=0)}var c=E-m;0>c&&(c=0),a>c&&(a=c),f(a)}function i(){var b=A>r,c=r+e>B;a.scrollRepeatClippingTop!==b&&a.$apply(function(){a.scrollRepeatClippingTop=b}),a.scrollRepeatClippingBottom!==c&&a.$apply(function(){a.scrollRepeatClippingBottom=c})}function o(){p.css("height",E/n*D+"px")}function s(){A=y();var a=Math.ceil(m/n);B=A+a*D,z(A)}function t(){if(D=w(),n=u(),F=v(),0===D)m=k,d=0;else{var a=Math.round(e/(D/n));m=a+a*k,m>l&&(m=l),d=Math.round((m-a)/2)}g(),o()}function u(){var a,b=1,d=c.children();for(var e in d){var f=d[e];if(!f||"object"!=typeof f)break;var g=x(f,"offsetTop");if(g>=0){if(angular.isUndefined(a)&&(a=g),g!=a)break;b=parseInt(e)+1}}return b}function v(){return c[0].offsetTop}function w(){return x(c.children()[0],"offsetHeight")}function x(a,b){var c=0;if(a&&"object"==typeof a){var d=a[b],e=angular.element(a).children()[0];if(e&&"object"==typeof e){var f=e[b];c=d>f?d:f}}return c}function y(){return Math.floor(C/n)*D}function z(a){var b="translateY("+a+"px)";c.css("transform",b),c.css("webkitTransform",b),c.css("mozTransform",b)}var A,B,C=0,D=0,E=0,F=0;a.scrollRepeatClippingTop=!1,a.scrollRepeatClippingBottom=!1,f(0),a.$watchCollection(q,function(a){a&&(E=a.length),b(function(){t()})}),j=function(a){a||g(),i()},h=function(){t()}}}}}]);